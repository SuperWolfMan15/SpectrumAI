<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>SpectrumAI</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden; /* запрет на прокрутку страницы */
  }
  body { 
    background: #111; 
    color: #fff; 
    font-family: sans-serif; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    height: 100vh; 
  }
  #chat { 
    width: 450px; 
    background: #222; 
    padding: 20px; 
    border-radius: 10px; 
  }
  #messages { 
    height: 250px; 
    overflow-y: auto; 
    margin-bottom: 10px; 
    border: 1px solid #444; 
    padding: 10px; 
    border-radius: 5px; 
  }
  input { 
    width: calc(100% - 60px); 
    padding: 5px; 
  }
  button { 
    width: 50px; 
    padding: 5px; 
  }
  .message { margin: 5px 0; }
  .user { color: #0f0; }
  .bot { color: #0ff; }
</style>
</head>
<body>
<div id="chat">
  <div id="messages"></div>
  <input type="text" id="input" placeholder="Напиши что-нибудь..." />
  <button onclick="sendMessage()">→</button>
</div>

<script>
const greetings = ["привет", "здравствуй", "хай", "добрый день"];
const thanks = ["спасибо", "благодарю", "thx"];
const mathPattern = /^[0-9+\-×:*/().,\s]+$/;

function gcd(a, b) {
  return b === 0 ? a : gcd(b, a % b);
}

function sendMessage() {
  const input = document.getElementById("input");
  const message = input.value.trim();
  if (!message) return;

  addMessage("Пользователь", message, "user");

  const msgLower = message.toLowerCase();
  let reply = "Извини, я не знаю ответа на это.";

  if (greetings.some(word => msgLower.includes(word))) {
    reply = "Привет! Я ИИ чат SpectrumAI, созданный студией iX. Я могу решать примеры. Пиши примеры таким образом: 2+2; 2×2; 2:2; 2-2; 1/2+1/3; 2,11+12,34;";
  }
  else if (thanks.some(word => msgLower.includes(word))) {
    reply = "Всегда пожалуйста, если что-то нужно — обращайся.";
  }
  else if (mathPattern.test(msgLower)) {
    try {
      let isFraction = message.includes("/");
      let isDecimalComma = message.includes(",");

      let expression = msgLower
        .replace(/×/g, "*")
        .replace(/:/g, "/")
        .replace(/,/g, ".");

      let result = eval(expression);

      if (isFraction) {
        let denominator = 100000;
        let numerator = Math.round(result * denominator);
        let divisor = gcd(numerator, denominator);
        numerator /= divisor;
        denominator /= divisor;
        reply = `В твоём уравнении ответ ${numerator}/${denominator}. Если что-то нужно ещё — пиши.`;
      } else if (isDecimalComma) {
        reply = `В твоём уравнении ответ ${result.toString().replace(".", ",")}. Если что-то нужно ещё — пиши.`;
      } else {
        reply = `В твоём уравнении ответ ${result}. Если что-то нужно ещё — пиши.`;
      }
    } catch {
      reply = "Похоже, здесь ошибка в примере. Проверь формат.";
    }
  }

  addMessage("Спектр", reply, "bot");
  input.value = "";
}

function addMessage(sender, text, cls) {
  const messages = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "message " + cls;
  div.textContent = sender + ": " + text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}
</script>
</body>
</html>
