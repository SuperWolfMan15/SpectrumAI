<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>SpectrumAI</title>
<style>
  html, body {
    margin: 0;
    background: #111;
    color: #fff;
    font-family: sans-serif;
  }
  body { 
    display: flex; 
    justify-content: center; 
    padding: 20px; 
  }
  #chat { 
    width: 600px; 
    background: #222; 
    padding: 20px; 
    border-radius: 15px; 
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  #model { 
    text-align: center; 
    font-size: 14px; 
    color: #aaa; 
  }
  #messages { 
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 10px; 
  }
  #input-area {
    display: flex;
    align-items: center;
  }
  input { 
    flex: 1;
    padding: 10px; 
    border-radius: 10px;
    border: none;
    outline: none;
  }
  button { 
    width: 60px; 
    padding: 10px; 
    margin-left: 10px;
    border: none;
    border-radius: 10px;
    background: #0ff;
    color: #000;
    font-weight: bold;
    cursor: pointer;
  }
  .message {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 15px;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
    white-space: pre-wrap;
  }
  .user {
    align-self: flex-end;
    background: #0f0;
    color: #000;
    border-bottom-right-radius: 0;
  }
  .bot {
    align-self: flex-start;
    background: #0ff;
    color: #000;
    border-bottom-left-radius: 0;
  }
</style>
</head>
<body>
<div id="chat">
  <div id="model">Model: SAI 1.2</div>
  <div id="messages"></div>
  <div id="input-area">
    <input type="text" id="input" placeholder="Напиши что-нибудь..." />
    <button onclick="sendMessage()">→</button>
  </div>
</div>

<script>
const greetings = ["привет", "здравствуй", "хай", "добрый день"];
const thanks = ["спасибо", "благодарю", "thx"];
const mathPattern = /^[0-9+\-×:*/().,\s]+$/;

function gcd(a, b) {
  return b === 0 ? a : gcd(b, a % b);
}

function sendMessage() {
  const input = document.getElementById("input");
  const message = input.value.trim();
  if (!message) return;

  addMessage(message, "user");

  const msgLower = message.toLowerCase();
  let reply = "Извини, я не знаю ответа на это.";

  const basicQnA = {
    "как дела": "У меня всё отлично! Готов решать примеры.",
    "что ты умеешь": "Я умею решать математические примеры, показывать дробные результаты и немного общаться.",
    "как тебя зовут": "Меня зовут Спектр.",
    "кто тебя создал": "Меня создала студия iX.",
    "чем ты занимаешься": "Помогаю людям решать примеры и быть полезным.",
    "как настроение": "Настроение отличное, спасибо что спросил!",
    "ты настоящий": "Я виртуальный ИИ, но могу общаться как собеседник.",
    "сколько тебе лет": "Я ещё молодой ИИ, версия SAI 1.2.",
    "где ты живешь": "Я живу прямо в этом приложении.",
    "ты умный": "Я стараюсь быть полезным! Особенно в математике.",
    "ты человек": "Нет, я искусственный интеллект.",
    "ты робот": "Скорее программа, чем робот.",
    "который час": "К сожалению, пока не умею показывать текущее время.",
    "какой сегодня день": "Сегодня прекрасный день! ☀️",
    "расскажи шутку": "Математики шутят так: ∞ лучше, чем ничего."
  };

  for (const question in basicQnA) {
    if (msgLower.includes(question)) {
      reply = basicQnA[question];
      break;
    }
  }

  if (greetings.some(word => msgLower.includes(word))) {
    reply = "Привет! Я ИИ чат SpectrumAI, созданный студией iX. Я могу решать примеры. Пиши примеры таким образом: 2+2; 2×2; 2:2; 2-2; 1/2+1/3; 2,11+12,34;";
  }
  else if (thanks.some(word => msgLower.includes(word))) {
    reply = "Всегда пожалуйста, если что-то нужно — обращайся.";
  }
  else if (mathPattern.test(msgLower)) {
    try {
      let isFraction = message.includes("/");
      let isDecimalComma = message.includes(",");

      let expression = msgLower
        .replace(/×/g, "*")
        .replace(/:/g, "/")
        .replace(/,/g, ".");

      let result = eval(expression);

      if (isFraction) {
        let denominator = 100000;
        let numerator = Math.round(result * denominator);
        let divisor = gcd(numerator, denominator);
        numerator /= divisor;
        denominator /= divisor;
        reply = `В твоём уравнении ответ ${numerator}/${denominator}. Если что-то нужно ещё — пиши.`;
      } else if (isDecimalComma) {
        reply = `В твоём уравнении ответ ${result.toString().replace(".", ",")}. Если что-то нужно ещё — пиши.`;
      } else {
        reply = `В твоём уравнении ответ ${result}. Если что-то нужно ещё — пиши.`;
      }
    } catch {
      reply = "Похоже, здесь ошибка в примере. Проверь формат.";
    }
  }

  addMessage(reply, "bot");
  input.value = "";

  // автоскролл вниз при каждом сообщении
  window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
}

function addMessage(text, cls) {
  const messages = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "message " + cls;
  div.textContent = text;
  messages.appendChild(div);
}
</script>
</body>
  </html>
